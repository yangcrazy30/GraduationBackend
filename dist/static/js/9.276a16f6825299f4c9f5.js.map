{"version":3,"sources":["webpack:///src/views/setting/pages/profile/setting.vue","webpack:///./src/views/setting/pages/profile/setting.vue?5b70","webpack:///./src/views/setting/pages/profile/setting.vue","webpack:///./src/api/upload/upload.js"],"names":["setting","data","_this","this","validatePass","rule","value","callback","Error","passwordform","checkpass","$refs","passform","validateField","disabled","oldpass","pass","activeName","imageUrl","baseUrl","config","baseURL","passwordrules","validator","trigger","computed","basicform","$store","state","account","methods","handleClick","tab","event","updateForm","formName","_this2","asyncToGenerator_default","regenerator_default","a","mark","_callee","wrap","_context","prev","next","validate","valid","userinfo","password","dispatch","stop","upload","file","_this3","_callee2","res","_context2","Object","upload_upload","sent","console","log","Math","random","beforeAvatarUpload","isLt2M","size","$message","error","profile_setting","render","_vm","_h","$createElement","_c","_self","on","tab-click","model","$$v","expression","attrs","label","name","ref","label-width","type","click","$event","_v","$set","directives","rawName","rules","prop","staticClass","action","http-request","show-file-list","before-upload","src","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","avatar","formData","FormData","append","axios","post","resource","courseId","path","__WEBPACK_IMPORTED_MODULE_0__utils_axios__"],"mappings":"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","file":"static/js/9.276a16f6825299f4c9f5.js","sourcesContent":["<template>\n  <div>\n    <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\n      <el-tab-pane label=\"基本资料\" name=\"first\">\n        <el-form :model=\"basicform\" ref=\"basic\" label-width=\"80px\">\n          <el-form-item label=\"Edit\">\n            <el-button type=\"primary\" @click=\"disabled = !disabled\">Edit</el-button>\n          </el-form-item>\n          <el-form-item label=\"UserName\">\n            <el-input v-model=\"basicform.username\" :disabled=\"disabled\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"Email\">\n            <el-input v-model=\"basicform.email\" :disabled=\"disabled\"></el-input>\n          </el-form-item>\n          <el-form-item v-show=\"!disabled\">\n            <el-button type=\"primary\" @click=\"updateForm('basic')\">Update</el-button>\n          </el-form-item>\n        </el-form>\n      </el-tab-pane>\n      <el-tab-pane label=\"密码管理\" name=\"second\">\n        <el-form :model=\"passwordform\" :rules=\"passwordrules\" ref=\"passform\" label-width=\"200px\">\n          <el-form-item label=\"Old Password\" prop=\"oldpass\">\n            <el-input v-model=\"passwordform.oldpass\" type=\"password\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"New Password\" prop=\"pass\">\n            <el-input v-model=\"passwordform.pass\" type=\"password\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"Confirm New Password\" prop=\"checkpass\">\n            <el-input v-model=\"passwordform.checkpass\" type=\"password\"></el-input>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"updateForm('passform')\">Update</el-button>\n          </el-form-item>\n        </el-form>\n      </el-tab-pane>\n      <el-tab-pane label=\"头像管理\" name=\"third\">\n        <div class=\"avataredit\">\n          <el-upload\n            class=\"avatar-uploader\"\n            action=\"/profile\"\n            :http-request=\"upload\"\n            :show-file-list=\"false\"\n            :before-upload=\"beforeAvatarUpload\"\n          >\n            <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\" />\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n          </el-upload>\n        </div>\n      </el-tab-pane>\n    </el-tabs>\n  </div>\n</template>\n\n<script>\nimport config from \"@/utils/config\";\nimport { uploadAvatar } from \"api/upload/upload\";\nexport default {\n  data() {\n    const validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入密码\"));\n      } else {\n        if (this.passwordform.checkpass !== \"\") {\n          this.$refs.passform.validateField(\"checkPass\");\n        }\n        callback();\n      }\n    };\n    const validatePass2 = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.passwordform.pass) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      disabled: true,\n      passwordform: {\n        oldpass: \"\",\n        pass: \"\",\n        checkpass: \"\"\n      },\n      activeName: \"first\",\n      imageUrl: \"\",\n      baseUrl: config.baseURL,\n      passwordrules: {\n        oldpass: [{ validator: validatePass, trigger: \"blur\" }],\n        pass: [{ validator: validatePass, trigger: \"blur\" }],\n        checkpass: [{ validator: validatePass2, trigger: \"blur\" }]\n      }\n    };\n  },\n  computed: {\n    basicform() {\n      return this.$store.state.account;\n    }\n  },\n  methods: {\n    handleClick(tab, event) {},\n    async updateForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          let userinfo = null;\n          userinfo =\n            formName === \"basic\"\n              ? this.basicform\n              : { password: this.passform.pass };\n          this.$store.dispatch(\"changeUserInfo\", userinfo);\n          this.disabled = true;\n        }\n      });\n    },\n    async upload(file) {\n      const res = await uploadAvatar(file);\n      console.log(res);\n      this.imageUrl = res.data.data + \"?r=\" + Math.random();\n      await this.$store.dispatch(\"updateAvatar\", {});\n    },\n    beforeAvatarUpload(file) {\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isLt2M) {\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\");\n      }\n      return isLt2M;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409eff;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n\n.avataredit {\n  display: flex;\n  flex-direction: row;\n}\n\n.avatar {\n  height: 200px;\n  width: 200px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/setting/pages/profile/setting.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-tabs',{on:{\"tab-click\":_vm.handleClick},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"基本资料\",\"name\":\"first\"}},[_c('el-form',{ref:\"basic\",attrs:{\"model\":_vm.basicform,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"Edit\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.disabled = !_vm.disabled}}},[_vm._v(\"Edit\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"UserName\"}},[_c('el-input',{attrs:{\"disabled\":_vm.disabled},model:{value:(_vm.basicform.username),callback:function ($$v) {_vm.$set(_vm.basicform, \"username\", $$v)},expression:\"basicform.username\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"Email\"}},[_c('el-input',{attrs:{\"disabled\":_vm.disabled},model:{value:(_vm.basicform.email),callback:function ($$v) {_vm.$set(_vm.basicform, \"email\", $$v)},expression:\"basicform.email\"}})],1),_vm._v(\" \"),_c('el-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.disabled),expression:\"!disabled\"}]},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.updateForm('basic')}}},[_vm._v(\"Update\")])],1)],1)],1),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"密码管理\",\"name\":\"second\"}},[_c('el-form',{ref:\"passform\",attrs:{\"model\":_vm.passwordform,\"rules\":_vm.passwordrules,\"label-width\":\"200px\"}},[_c('el-form-item',{attrs:{\"label\":\"Old Password\",\"prop\":\"oldpass\"}},[_c('el-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.passwordform.oldpass),callback:function ($$v) {_vm.$set(_vm.passwordform, \"oldpass\", $$v)},expression:\"passwordform.oldpass\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"New Password\",\"prop\":\"pass\"}},[_c('el-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.passwordform.pass),callback:function ($$v) {_vm.$set(_vm.passwordform, \"pass\", $$v)},expression:\"passwordform.pass\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"Confirm New Password\",\"prop\":\"checkpass\"}},[_c('el-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.passwordform.checkpass),callback:function ($$v) {_vm.$set(_vm.passwordform, \"checkpass\", $$v)},expression:\"passwordform.checkpass\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.updateForm('passform')}}},[_vm._v(\"Update\")])],1)],1)],1),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"头像管理\",\"name\":\"third\"}},[_c('div',{staticClass:\"avataredit\"},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"/profile\",\"http-request\":_vm.upload,\"show-file-list\":false,\"before-upload\":_vm.beforeAvatarUpload}},[(_vm.imageUrl)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.imageUrl}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],1)])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-526ea033\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/setting/pages/profile/setting.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-526ea033\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./setting.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./setting.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./setting.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-526ea033\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./setting.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-526ea033\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/setting/pages/profile/setting.vue\n// module id = null\n// module chunks = ","import axios from \"@/utils/axios\";\n\nexport function uploadAvatar(avatar) {\n  let formData = new FormData();\n  formData.append(\"avatar\", avatar.file);\n  return axios.post(\"/upload/avatar\", formData);\n}\n\n\nexport function uploadResource(resource, courseId, path) {\n  let formData = new FormData();\n  formData.append(\"courseId\", courseId);\n  formData.append(\"path\", path);\n  formData.append(\"resource\", resource.file);\n  return axios.post(\"/resource/upload\", formData);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/api/upload/upload.js"],"sourceRoot":""}