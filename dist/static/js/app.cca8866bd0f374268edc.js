webpackJsonp([20],{"9pcb":function(e,n,t){"use strict";n.d=function(e){return a.a.post("/users/signup",{username:e.username,email:e.email,password:e.password,role:e.role})},n.c=function(e){return a.a.post("/users/login",{email:e.email,password:e.password})},n.a=function(){return a.a.get("/users/userinfo")},n.e=function(e){return a.a.post("/users/userinfo",e)},n.b=function(e){return a.a.get("/users/uibyemail",{params:{email:e}})};var a=t("cKc3")},DJeI:function(e,n){},NHnr:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("7+uW"),r=t("Xxa5"),o=t.n(r),i=t("exGp"),u=t.n(i),s={name:"App",data:function(){return{avtiveIndex:"0",menus:[{}],_beforeUnload_time:0,_gap_time:0}},mounted:function(){var e,n=this;window.addEventListener("beforeunload",function(e){n.beforeunloadHandler(e);var t=navigator.userAgent,a=t.indexOf("Opera")>-1;if(a)return"Opera";if(t.indexOf("Firefox")>-1)n.unloadHandler();else if(t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!a){var r=(e=e||(window.event?window.event:null)).clientY||e.target.event.clientY,o=e.altKey||e.target.event.altKey;(r<0||o)&&n.unloadHandler()}}),window.addEventListener("unload",(e=u()(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.unloadHandler(t);case 1:case"end":return e.stop()}},e,n)})),function(n){return e.apply(this,arguments)}))},destroyed:function(){var e=this;window.removeEventListener("beforeunload",function(n){return e.beforeunloadHandler(n)}),window.removeEventListener("unload",function(n){return e.unloadHandler(n)})},methods:{beforeunloadHandler:function(e){this._beforeUnload_time=(new Date).getTime()},unloadHandler:function(e){this._gap_time=(new Date).getTime()-this._beforeUnload_time,localStorage.setItem("time",this._gap_time),this._gap_time<=5&&localStorage.removeItem("ujs")},handleNavSelect:function(e,n){this.$router.push({name:e})},jumpToLogin:function(){this.$router.push({path:"/signup"})},jumpToProfile:function(){this.$router.push({path:"/profile"})},jumpToHome:function(){"/"!==this.$route.path&&this.$router.push({path:"/"})},logout:function(){this.$store.dispatch("logout")}},computed:{username:function(){return this.$store.state.account.username}}},c={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("header",{staticClass:"head"},[t("div",{staticClass:"topmenu"},[t("div",{on:{click:e.jumpToHome}},[t("strong",{staticStyle:{padding:"0 1rem"}},[e._v("UJSOnline")])]),e._v(" "),t("div",{staticClass:"login"},[t("i",{staticClass:"iconfont icon-touxiang1",on:{click:e.jumpToProfile}}),e._v(" "),""===e.username?t("span",{on:{click:e.jumpToLogin}},[t("span",[e._v("my")]),e._v(" "),t("strong",[e._v("UJSOnline")]),e._v(" "),t("span",[e._v("connection")])]):t("span",{on:{click:e.jumpToProfile}},[t("strong",[e._v(e._s(e.username))]),e._v(" "),t("i",{staticClass:"iconfont icon-log-out",on:{click:e.logout}})])])]),e._v(" "),t("nav",[t("el-menu",{attrs:{mode:"horizontal","default-active":e.avtiveIndex,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleNavSelect}},[t("el-menu-item",{attrs:{index:"allcourse"}},[e._v("Course")])],1)],1)]),e._v(" "),t("router-view"),e._v(" "),e._m(0)],1)},staticRenderFns:[function(){var e=this.$createElement,n=this._self._c||e;return n("footer",{staticClass:"footer"},[n("div",{staticClass:"botLogo"},[n("span",[this._v("University Of")]),this._v(" "),n("span",[this._v("JiangSu")])]),this._v(" "),n("div",{staticClass:"botMessage"})])}]};var l=t("VU/8")(s,c,!1,function(e){t("dRge"),t("DJeI")},"data-v-2d5cf104",null).exports,d=t("Gu7T"),m=t.n(d),p=t("lHA8"),f=t.n(p),h=t("/ocq"),v=t("NYxO"),g=t("9pcb"),b={state:{username:"",role:"",email:"",avatar:"",id:""},getters:{isLoggedIn:function(e){return!!e.email&&!!e.role}},actions:{login:function(e,n){var t=this,a=e.commit,r=e.getters,i=n.email,s=n.password;return u()(o.a.mark(function e(){var n,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isLoggedIn){e.next=2;break}return e.abrupt("return");case 2:if(!localStorage.getItem("ujs")){e.next=8;break}return e.next=5,Object(g.a)();case 5:return n=e.sent,a("login",n.data.data),e.abrupt("return");case 8:if(i&&s){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,Object(g.c)({email:i,password:s});case 12:if(!(u=e.sent).data.success){e.next=19;break}return localStorage.setItem("ujs",u.data.data.token),a("login",u.data.data),e.abrupt("return",u);case 19:throw new Error(u.data.data.err);case 20:case"end":return e.stop()}},e,t)}))()},logout:function(e){var n=this,t=e.commit;return u()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t("logout");case 1:case"end":return e.stop()}},e,n)}))()},updateAvatar:function(e){var n=this,t=e.commit;return u()(o.a.mark(function e(){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)();case 2:a=e.sent,t("login",a.data.data);case 4:case"end":return e.stop()}},e,n)}))()},changeUserInfo:function(e,n){var t=this,a=e.commit;return u()(o.a.mark(function e(){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.e)(n);case 2:return e.next=4,Object(g.a)();case 4:r=e.sent,localStorage.setItem("ujs",r.data.data.token),a("login",r.data.data);case 7:case"end":return e.stop()}},e,t)}))()}},mutations:{login:function(e,n){e.email=n.email,e.username=n.username,e.role=n.role,e.avatar=n.avatar+"?r="+Math.random(),e.id=n.id},logout:function(e){e.username="",e.role="",e.email="",e.avatar="",e.id="",localStorage.clear()}}};a.default.use(v.a);var w=new v.a.Store({modules:{account:b}}),_=[{path:"/",component:function(){return Promise.all([t.e(0),t.e(16)]).then(t.bind(null,"KO1w"))}}],x=[{name:"allcourse",path:"/allcourse",component:function(){return Promise.all([t.e(0),t.e(8)]).then(t.bind(null,"YgBn"))}},{name:"course",path:"/course/:id",component:function(){return Promise.all([t.e(0),t.e(4)]).then(t.bind(null,"CWjW"))}}],k=[{path:"/login",component:function(){return t.e(11).then(t.bind(null,"EbLB"))}},{path:"/signup",component:function(){return Promise.all([t.e(0),t.e(12)]).then(t.bind(null,"SO18"))}}],j={path:"/study/:id",component:function(){return t.e(14).then(t.bind(null,"apb7"))},children:[{name:"study",path:"/",component:function(){return t.e(18).then(t.bind(null,"4Svj"))}},{name:"question",path:"question",component:function(){return Promise.all([t.e(0),t.e(2)]).then(t.bind(null,"rS5e"))}},{name:"homework",path:"homework",component:function(){return Promise.all([t.e(0),t.e(5)]).then(t.bind(null,"GJ3N"))}},{name:"bbs",path:"bbs",component:function(){return t.e(6).then(t.bind(null,"uS5C"))}},{path:"bbs/detail/:postid",name:"bbsdetail",component:function(){return t.e(7).then(t.bind(null,"qjbD"))}},{path:"homework/detail/:homeworkid",name:"homeworkdetail",component:function(){return t.e(10).then(t.bind(null,"a7WE"))}},{name:"resource",path:"resource",component:function(){return t.e(1).then(t.bind(null,"lIre"))}},{name:"management",path:"management",component:function(){return Promise.all([t.e(0),t.e(17)]).then(t.bind(null,"G3Uz"))}}]},S={path:"/profile",component:function(){return t.e(13).then(t.bind(null,"tKlK"))},children:[{name:"setting",path:"setting",component:function(){return t.e(9).then(t.bind(null,"RI2B"))}},{name:"mycourse",path:"course",component:function(){return Promise.all([t.e(0),t.e(15)]).then(t.bind(null,"D7SI"))}},{name:"chat",path:"chat",component:function(){return Promise.all([t.e(0),t.e(3)]).then(t.bind(null,"kRap"))}}]};a.default.use(h.a);var I=new f.a(["/login","/signup","/"]),O=new h.a({routes:[].concat(m()(_),m()(x),m()(k),[S,j])});O.beforeEach(function(e,n,t){I.has(e.path)?t():w.getters.isLoggedIn?t():t({path:"/login",query:{redirect:e.fullPath}})});var L=O,y=t("zL8q"),E=t.n(y),H=(t("tvR6"),t("HI0L")),P=t.n(H),U=t("uJsh"),C=t.n(U);a.default.use(new P.a({debug:!1,connection:"http://101.200.209.120:3000"})),a.default.use(E.a),a.default.use(C.a),a.default.config.productionTip=!1,L.afterEach(function(e,n){window.scrollTo(0,0)}),new a.default({el:"#app",router:L,store:w,components:{App:l},template:"<App/>"})},bzuE:function(e,n,t){"use strict";var a={production:{baseURL:"http://101.200.209.120:3000"},development:{baseURL:"http://127.0.0.1:3000"}};n.a=a.production},cKc3:function(e,n,t){"use strict";var a=t("mtWM"),r=t.n(a),o=t("mw3O"),i=t.n(o),u=t("bzuE");r.a.defaults.baseURL=u.a.baseURL,r.a.defaults.withCredentials=!0,r.a.interceptors.request.use(function(e){return e.headers.common.Authorization="Bearer "+localStorage.getItem("ujs"),"get"===e.method&&(e.paramsSerializer=function(e){return i.a.stringify(e,{arrayFormat:"repeat"})}),e}),n.a=r.a},dRge:function(e,n){},tvR6:function(e,n){}},["NHnr"]);
//# sourceMappingURL=app.cca8866bd0f374268edc.js.map